# AIOps Agent å¿«é€Ÿæµ‹è¯•æŒ‡å—

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. ä½¿ç”¨è‡ªåŠ¨åŒ–æµ‹è¯•è„šæœ¬ï¼ˆæ¨èï¼‰

```bash
# å®Œæ•´æµ‹è¯•æ‰€æœ‰APIåŠŸèƒ½
./test_all_apis.sh

# æµ‹è¯•æŒ‡å®šæœåŠ¡å™¨
./test_all_apis.sh -s 10.0.0.202

# åªè·å–APIä»¤ç‰Œ
./test_all_apis.sh -g

# æ¸…ç†ä»¤ç‰Œæ–‡ä»¶
./test_all_apis.sh -c
```

### 2. ä½¿ç”¨Pythonæµ‹è¯•è„šæœ¬

```bash
# å®Œæ•´æµ‹è¯•ä¸¤ä¸ªæœåŠ¡å™¨
python3 tests/test_shell_execution.py --url https://10.0.0.30:8443 --server both

# æµ‹è¯•å•ä¸ªæœåŠ¡å™¨
python3 tests/test_shell_execution.py --url https://10.0.0.30:8443 --server 30
```

## ğŸ”‘ æ‰‹åŠ¨æµ‹è¯•ï¼ˆcurlå‘½ä»¤ï¼‰

### è·å–APIä»¤ç‰Œ
```bash
curl -X POST https://10.0.0.30:8443/auth/api-key \
  -H "Content-Type: application/json" \
  -d '{"user_id":"test_user","permissions":["execute","read","write"]}' \
  -k
```

### ä¿å­˜ä»¤ç‰Œ
```bash
export TOKEN="ä½ çš„ä»¤ç‰Œ"
```

### åŸºæœ¬åŠŸèƒ½æµ‹è¯•

```bash
# å¥åº·æ£€æŸ¥
curl -X GET https://10.0.0.30:8443/health -H "Authorization: Bearer $TOKEN" -k

# çŠ¶æ€æ£€æŸ¥
curl -X GET https://10.0.0.30:8443/status -H "Authorization: Bearer $TOKEN" -k

# æ‰§è¡Œå‘½ä»¤
curl -X POST https://10.0.0.30:8443/exec/command \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer $TOKEN" \
  -d '{"command":"echo \"Hello World\""}' \
  -k

# ç”¨æˆ·åˆ‡æ¢
curl -X POST https://10.0.0.30:8443/exec/command \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer $TOKEN" \
  -d '{"command":"sudo -u app bash -c \"whoami && pwd\""}' \
  -k
```

## ğŸ“‹ æµ‹è¯•æ¸…å•

### âœ… å¿…æµ‹åŠŸèƒ½
- [ ] è·å–APIä»¤ç‰Œ
- [ ] å¥åº·æ£€æŸ¥
- [ ] çŠ¶æ€æ£€æŸ¥
- [ ] åŸºæœ¬å‘½ä»¤æ‰§è¡Œ
- [ ] ç”¨æˆ·åˆ‡æ¢æ‰§è¡Œ
- [ ] åŠ¨æ€è„šæœ¬æ‰§è¡Œ

### ğŸ”§ å¯é€‰æµ‹è¯•
- [ ] ç”¨æˆ·ä¿¡æ¯æŸ¥è¯¢
- [ ] è„šæœ¬æ–‡ä»¶æ‰§è¡Œ
- [ ] APIå¯†é’¥éªŒè¯

## ğŸ¯ å…³é”®éªŒè¯ç‚¹

1. **è®¤è¯ç³»ç»Ÿ**: ç¡®ä¿Bearerä»¤ç‰Œæ­£å¸¸å·¥ä½œ
2. **å‘½ä»¤æ‰§è¡Œ**: éªŒè¯shellå‘½ä»¤å¯ä»¥æ­£ç¡®æ‰§è¡Œ
3. **ç”¨æˆ·æƒé™**: æµ‹è¯•ç”¨æˆ·åˆ‡æ¢åŠŸèƒ½
4. **è„šæœ¬æ‰§è¡Œ**: éªŒè¯åŠ¨æ€è„šæœ¬ç”Ÿæˆå’Œæ‰§è¡Œ
5. **è·¨æœåŠ¡å™¨**: åœ¨ä¸¤ä¸ªæœåŠ¡å™¨ä¸Šæµ‹è¯•å…¼å®¹æ€§

## âš¡ ä¸€é”®æµ‹è¯•

åˆ›å»ºå¿«é€Ÿæµ‹è¯•è„šæœ¬ `quick_test.sh`:

```bash
#!/bin/bash
./test_all_apis.sh && python3 tests/test_shell_execution.py --url https://10.0.0.30:8443 --server both
```

## ğŸ“Š é¢„æœŸç»“æœ

- âœ… æ‰€æœ‰APIè°ƒç”¨è¿”å›200çŠ¶æ€ç 
- âœ… å‘½ä»¤æ‰§è¡Œè¾“å‡ºæ­£ç¡®
- âœ… ç”¨æˆ·åˆ‡æ¢åŠŸèƒ½æ­£å¸¸
- âœ… åŠ¨æ€è„šæœ¬å¯ä»¥æ‰§è¡Œ
- âœ… ä¸¤ä¸ªæœåŠ¡å™¨è¡¨ç°ä¸€è‡´

## ğŸ” æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜
1. **è®¤è¯å¤±è´¥**: é‡æ–°è·å–ä»¤ç‰Œ
2. **è¿æ¥è¶…æ—¶**: æ£€æŸ¥æœåŠ¡å™¨çŠ¶æ€
3. **å‘½ä»¤å¤±è´¥**: éªŒè¯å‘½ä»¤è¯­æ³•
4. **æƒé™é”™è¯¯**: æ£€æŸ¥ç”¨æˆ·æƒé™

### è°ƒè¯•å‘½ä»¤
```bash
# æ£€æŸ¥æœåŠ¡å™¨çŠ¶æ€
ssh root@10.0.0.30 "systemctl status aiops-agent"

# æŸ¥çœ‹æ—¥å¿—
ssh root@10.0.0.30 "tail -f /opt/aiops-agent/logs/server.log"

# æ£€æŸ¥ç½‘ç»œ
ping 10.0.0.30
```

## ğŸ“ æ”¯æŒä¿¡æ¯

- **æ–‡æ¡£**: æŸ¥çœ‹ `API_TESTING_GUIDE.md` è·å–è¯¦ç»†APIè¯´æ˜
- **è„šæœ¬**: ä½¿ç”¨æä¾›çš„è‡ªåŠ¨åŒ–æµ‹è¯•è„šæœ¬
- **æ—¥å¿—**: æ£€æŸ¥æœåŠ¡å™¨æ—¥å¿—è·å–è¯¦ç»†é”™è¯¯ä¿¡æ¯

---

**æç¤º**: å»ºè®®å…ˆä½¿ç”¨è‡ªåŠ¨åŒ–è„šæœ¬è¿›è¡Œå®Œæ•´æµ‹è¯•ï¼Œå†ä½¿ç”¨curlå‘½ä»¤è¿›è¡Œé’ˆå¯¹æ€§æµ‹è¯•ã€‚